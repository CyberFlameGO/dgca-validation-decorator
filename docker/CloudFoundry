FROM adoptopenjdk:11-jre-hotspot as build
COPY ./target/*.jar /app/app.jar
WORKDIR /app

FROM nginx:alpine
COPY --from=build ./app /app
COPY ./nginx/default.conf.template /etc/nginx/conf.d/default.conf
COPY ./entrypoint/entrypoint.sh /entrypoint.sh
COPY ./certs/dev-test.jks /certs/dev-test.jks
COPY ./certs/dev-decorator.jks /certs/dev-decorator.jks
RUN apk --no-cache add openjdk11-jre
EXPOSE 8080
CMD sh ./entrypoint.sh
